<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <title>Storgate</title>

    <script type="text/javascript" src="web3.js"></script>
    <script type="text/javascript">
    window.addEventListener('load', function() {
        
        if (typeof web3 !== 'undefined') {
            console.log('Web3 Detected! ' + web3.currentProvider.constructor.name)
            window.web3 = new Web3(web3.currentProvider);
            web3.currentProvider.publicConfigStore.on('update', getNetwork);
            getNetwork()
        } else {
            let output = document.getElementById('output');
            output.innerHTML = 'Please download and install Metamask: <a href="https://metamask.io/">https://metamask.io/</a>'
        }
    });

    function getNetwork() {
        let output = document.getElementById('output');
        let net;
        web3.version.getNetwork((err, netId) => {
            switch (netId) {
                case "1":
                    net = 'This is mainnet';
                    break
                case "2":
                    net = 'This is the deprecated Morden test network.'
                    break
                case "3":
                    net = 'This is the ropsten test network.';
                    break
                case "4":
                    net = 'This is the Rinkeby test network.';
                    break
                case "42":
                    net = 'This is the Kovan test network.';
                    break
                default:
                    net = 'This is an unknown network.';
            };

            output.innerHTML = net;
            web3.eth.getAccounts(accounts => console.log(accounts[0]))
        })
    }
    </script>
</head>

<body>
    <div class="container">
        <div class="marginBottom" id="output">Test web3</div>
        <nav>
            <a class="nav__link marginRight" href="./register.html">Register</a>
            <a class="nav__link" href="./index.html">About</a>
        </nav>
        <div class="register__buttonGroup">
            <button class="register__button">Name</button>
            <button class="register__button">Resolvor</button>
            <button class="register__button">Onion</button>
            <p class="register_text">Success</p>
        </div>
    </div>
</body>

</html>